<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">

    <title>Carrito de Productos</title>
</head>
<body>
    <div class="container">
        <h1>Manejo de Carrito de Compras - Productos</h1>
        <div class="alert d-none" role="alert" id="message"></div>
        <form>
            <div class="mb-3">
                <label for="reference" class="form-label">Referencia</label>
                <input type="text" class="form-control" id="reference" placeholder="Ingresar referencia">
                <span id="mreference" style="color: red; font-weight: bold;"></span>
            </div>
            <div class="mb-3">
                <label for="description" class="form-label" >Descripcion</label>
                <input type="text" class="form-control" id="description" placeholder="Ingresar descripcion">
                <span id="mdescription" style="color: red; font-weight: bold;"></span>
            </div>
            <div class="mb-3">
                <label for="unitprice" class="form-label" >Precio Unitario</label>
                <input type="text" class="form-control" id="unitprice" placeholder="Ingresar precio unitario">
                <span id="munitprice" style="color: red; font-weight: bold;"></span>
            </div>
            <div class="mb-3">
                <label for="stock" class="form-label" >Existencia</label>
                <input type="text" class="form-control" id="stock" placeholder="Ingresar existencia">
                <span id="mstock" style="color: red; font-weight: bold;"></span>
            </div>

            <button type="button" class="btn btn-primary" id="btnadd">Agregar</button>
            <button type="button" class="btn btn-secondary" id="btnsearch">Buscar</button>
            <button type="button" class="btn btn-success" id="btnupdate">Actualizar</button>
            <button type="button" class="btn btn-danger" id="btndelete">Eliminar</button>
            <button type="button" class="btn btn-info" id="btnlist">Listar</button>
        </form>
    </div>

    <script>
        //referenciar los elementos de HTML con ID en JS
        /*Referenciar los mensajes*/
        let message = document.getElementById('message');
        let mreference = document.getElementById('mreference');
        let mdescription = document.getElementById('mdescription');
        let munitprice = document.getElementById('munitprice');
        let mstock = document.getElementById('mstock');
      
        /*Referenciar los Input*/
        let reference = document.querySelector('#reference');
        let description = document.getElementById('description');
        let unitprice = document.querySelector('#unitprice');
        let stock = document.getElementById('stock');

        /*Referenciar los Botones*/
        let btnadd = document.querySelector('#btnadd');
        let btnsearch = document.querySelector('#btnsearch');
        let btnupdate = document.querySelector('#btnupdate');
        let btndelete = document.querySelector('#btndelete');
        let btnlist = document.querySelector('#btnlist');

        /*Definir el Arreglo de los Objetos para los Productos*/
        let productos = [
            {reference:'A1', description:'Mouse', unitprice:25000, stock:10},
            {reference:'A2', description:'Teclado', unitprice:35000, stock:20},
        ]

        //message.style.display = 'none';

        //Eventos
        reference.addEventListener('focus',()=>{
            mreference.textContent = "Ingrese la Referencia del Producto";
        });
        reference.addEventListener('blur',()=>{
            mreference.textContent = "";
        });

        description.addEventListener('focus',()=>{
            mdescription.textContent = "Ingrese la Descripcion del Producto";
        });
        description.addEventListener('blur',()=>{
            mdescription.textContent = "";
        });

        unitprice.addEventListener('focus',()=>{
            munitprice.textContent = "Ingrese Precio del Producto";
        });
        unitprice.addEventListener('blur',()=>{
            munitprice.textContent = "";
        });

        stock.addEventListener('focus',()=>{
            mstock.textContent = "Ingrese la Existencia del Producto";
        });
        stock.addEventListener('blur',()=>{
            mstock.textContent = "";
        });

        //Evento clic del boton agregar
        btnadd.addEventListener('click',()=>{
            if (reference.value != "" && description.value != "" && unitprice.value != "" && stock.value != ""){
                //Guardar el producto en el arreglo de productos
                //buscar la referencia del producto...
                let buscarProducto = productos.find(prod => prod.reference == reference.value)
                message.classList.remove("d-none");
                if (buscarProducto == undefined){
                    //No encuentra el objeto con esa referencia 
                    //Generar el Objeto con cada uno de los datos del producto cotenidos en cada input
                    let nvoproducto = {reference:reference.value, description:description.value, unitprice:parseInt(unitprice.value), stock:parseInt(stock.value)};
                    productos.push(nvoproducto);
                    console.log(productos);   
                    //Emitir el mensaje de producto guardado correctamente en el elemento message
                    message.classList.add("alert-success");
                    message.textContent = "Producto guardado Correctamente ...";
                    //Retardo de 3 segundos en el message para simular una comunicacion asincrona con un server
                    setTimeout(() => {
                        message.classList.remove('alert-success');
                        message.classList.add("d-none");
                    }, 3000);
                               
                }else{
                    message.classList.add("alert-danger");
                    message.textContent = "La referencia ya Existe. Intente con otra ...";
                }
            }
            else{
                if (reference.value == ""){
                    mreference.textContent = "* La Referencia es obligatoria"
                }
                if (description.value == ""){
                    mdescription.textContent = "* La Descripcion es obligatoria"
                }
                if (unitprice.value == ""){
                    munitprice.textContent = "* El precio es obligatorio"
                }
                if (stock.value == ""){
                    mstock.textContent = "* El existencia es obligatoria"
                }
                message.classList.remove('d-none');
                message.classList.add("alert-danger");
                message.textContent = "Debe Ingresar todos los datos..."
            }
        })

        //Evento clic del boton Buscar
        //buscar por referencia
        btnsearch.addEventListener('click',()=>{
            let buscarProducto = productos.find(prod => prod.reference == reference.value)
            if (buscarProducto == undefined){
                message.classList.add("alert-danger");
                message.textContent = "La referencia no Existe. Intente con otra ...";

            }else{

            }
        })

    


        
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js" integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN" crossorigin="anonymous"></script>
   
    
</body>
</html>